(this.webpackJsonpmafia_vk_mini_app=this.webpackJsonpmafia_vk_mini_app||[]).push([[0],{133:function(e,t,c){},153:function(e,t,c){},154:function(e,t,c){},155:function(e,t,c){},156:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(29),r=c.n(a),s=c(17),l=c.n(s),i=c(6),j=c(2),o=(c(132),c(133),"Intro"),u="Home",b="CreateGame",d="JoinGame",O="WaitGame",m="Game",h="Mafia",p="Police",f="Civils",x=c(1);function g(e){var t=e.setActivePanel,c=e.panelHeaderMessage;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:c}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){return t(b)},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){return t(d)},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})}var v=c(25),y=c(26),S=c(18),k=c.n(S),C="https://mafia2cards.herokuapp.com/api",P=1,I=2,w=0,M=1,H=2,A=3,U=4,N=0,F=1,z=2,W=3,G=4,_=5,E=0,T=1,V=2,K=0,q=2,J=0,D=1,B=function(){return k.a.get("".concat(C,"/game2/wakeup"))},L=function(e,t,c,n,a){return k.a.post("".concat(C,"/game2/create"),{creatorName:e,playerPhotoUrl:t,civilsNumber:c,mafiaNumber:n,hasPolice:a})},Q=function(e,t,c){return k.a.post("".concat(C,"/game2/join"),{playerName:e,playerPhotoUrl:t,gameId:c})},R=function(e){return k.a.get("".concat(C,"/game2/get/").concat(e))},X=function(e){return k.a.post("".concat(C,"/game2/start"),{gameId:e})},Y=function(e,t){return k.a.post("".concat(C,"/game2/startNight"),{gameId:e,playerId:t})},Z=function(e,t,c){return k.a.post("".concat(C,"/game2/mafiaKill"),{gameId:e,playerId:t,playerVoteValue:c})},$=function(e){return k.a.post("".concat(C,"/game2/endNight"),{gameId:e})},ee=function(e,t){return k.a.post("".concat(C,"/game2/startTrial"),{gameId:e,playerId:t})},te=function(e,t,c){return k.a.post("".concat(C,"/game2/civilsKill"),{gameId:e,playerId:t,playerVoteValue:c})},ce=c(157);function ne(e){var t=e.closeSnackbar,c=e.errorMessage;return Object(x.jsx)(j.v,{onClose:t,before:Object(x.jsx)(ce.a,{}),children:c})}function ae(e){var t=e.setActivePanel,c=e.setGame,a=e.setPlayerId,r=e.subscribeToGame,s=e.panelHeaderMessage,l=e.playerPhotoUrl,o=Object(n.useState)(""),b=Object(i.a)(o,2),d=b[0],m=b[1],h=Object(n.useState)(5),p=Object(i.a)(h,2),f=p[0],g=p[1],S=Object(n.useState)(1),k=Object(i.a)(S,2),C=k[0],P=k[1],I=Object(n.useState)(!1),w=Object(i.a)(I,2),M=w[0],H=w[1],A=Object(n.useState)({name:!1,numberOfCivils:!1,numberOfMafia:!1}),U=Object(i.a)(A,2),N=U[0],F=U[1],z=Object(n.useState)(null),W=Object(i.a)(z,2),G=W[0],_=W[1],E=Object(n.useState)(null),T=Object(i.a)(E,2),V=T[0],K=T[1],q=Object(n.useState)("valid"),J=Object(i.a)(q,2),D=J[0],B=J[1],Q=Object(n.useState)(""),R=Object(i.a)(Q,2),X=R[0],Y=R[1],Z=Object(n.useState)("valid"),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ce=Object(n.useState)(""),ae=Object(i.a)(ce,2),re=ae[0],se=ae[1],le=function(e){F(Object(y.a)(Object(y.a)({},N),{},Object(v.a)({},e,!0)))};return Object(n.useEffect)((function(){var e=Number(C),t=Number(f),c=!1,n=!1;e<1&&(B("error"),Y("\u041c\u0430\u0444\u0438\u0438 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 0"),c=!0),t<3&&(te("error"),se("\u041c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 2"),n=!0),e===t&&(B("error"),Y("\u041c\u0430\u0444\u0438\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u0442\u043e\u043b\u044c\u043a\u043e \u0436\u0435, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439"),c=!0),e>t&&(B("error"),Y("\u041c\u0430\u0444\u0438\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439"),c=!0),c||(B("valid"),Y("")),n||(te("valid"),se(""))}),[C,f]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:s}),Object(x.jsx)(j.x,{popout:V,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.i,{onSubmit:function(e){e.preventDefault()},children:[Object(x.jsx)(j.h,{top:"\u0418\u043c\u044f",status:d?"valid":N.name?"error":"default",bottom:!d&&N.name?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"name",value:d,onChange:function(e){m(e.currentTarget.value)},onFocus:function(e){return le("name")},placeholder:"\u041c\u043e\u0435 \u0438\u043c\u044f"})}),Object(x.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439",status:ee,bottom:re,children:Object(x.jsx)(j.l,{type:"number",name:"numberOfCivils",value:f,onChange:function(e){g(e.target.value)},onFocus:function(e){return le("numberOfCivils")}})}),Object(x.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0444\u0438\u0438",status:D,bottom:X,children:Object(x.jsx)(j.l,{type:"number",name:"numberOfMafia",value:C,onChange:function(e){P(e.currentTarget.value)},onFocus:function(e){return le("numberOfMafia")}})}),Object(x.jsx)(j.f,{value:M,onChange:function(e){return H(e.currentTarget.checked)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u0438\u0441\u0441\u0430\u0440\u0430"}),Object(x.jsx)(j.h,{children:Object(x.jsx)(j.c,{mode:"commerce",type:"submit",stretched:!0,size:"l",disabled:!d||"error"===ee||"error"===D,onClick:function(){K(Object(x.jsx)(j.s,{})),L(d,l,Number(f),Number(C),M).then((function(e){c(e.data.game),a(e.data.playerId),r(e.data.game.id),t(O)})).catch((function(e){var t=e.response.data.message;_(t)})).finally((function(){K(null)}))},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})})]})}),G&&Object(x.jsx)(ne,{errorMessage:G,closeSnackbar:function(){return _(null)}})]})})]})}function re(e){var t=e.setActivePanel,c=e.setGame,a=e.setPlayerId,r=e.subscribeToGame,s=e.panelHeaderMessage,l=e.playerPhotoUrl,o=Object(n.useState)(""),b=Object(i.a)(o,2),d=b[0],h=b[1],p=Object(n.useState)(""),f=Object(i.a)(p,2),g=f[0],S=f[1],k=Object(n.useState)({roomCode:!1,name:!1}),C=Object(i.a)(k,2),I=C[0],w=C[1],M=Object(n.useState)(null),H=Object(i.a)(M,2),A=H[0],U=H[1],N=Object(n.useState)(null),F=Object(i.a)(N,2),z=F[0],W=F[1],G=function(e){w(Object(y.a)(Object(y.a)({},I),{},Object(v.a)({},e,!0)))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:s}),Object(x.jsx)(j.x,{popout:z,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.i,{onSubmit:function(e){e.preventDefault()},children:[Object(x.jsx)(j.h,{top:"\u041a\u043e\u0434 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",status:d?"valid":I.roomCode?"error":"default",bottom:!d&&I.roomCode?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"roomCode",value:d,onChange:function(e){h(e.currentTarget.value.toUpperCase())},onFocus:function(e){return G("roomCode")},placeholder:"MF12P5"})}),Object(x.jsx)(j.h,{top:"\u0418\u043c\u044f",status:g?"valid":I.name?"error":"default",bottom:!g&&I.name?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"name",value:g,onChange:function(e){S(e.currentTarget.value)},onFocus:function(e){return G("name")},placeholder:"\u0422\u0432\u043e\u0435 \u0438\u043c\u044f"})}),Object(x.jsx)(j.h,{children:Object(x.jsx)(j.c,{mode:"commerce",type:"submit",stretched:!0,size:"l",disabled:!d||!g,onClick:function(){W(Object(x.jsx)(j.s,{})),Q(g,l,d).then((function(e){c(e.data.game),a(e.data.playerId),r(e.data.game.id),e.data.game.gameStatus!==P?t(O):t(m)})).catch((function(e){var t=e.response.data.message;U(t)})).finally((function(){W(null)}))},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})}),A&&Object(x.jsx)(ne,{errorMessage:A,closeSnackbar:function(){return U(null)}})]})})]})}c(153);function se(e){var t=e.setActivePanel,c=e.panelHeaderMessage,a=e.game,r=e.playerId,s=a.players.find((function(e){return e.id===r})),l=Object(n.useState)(null),o=Object(i.a)(l,2),b=o[0],d=o[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:c}),Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.g,{children:[Object(x.jsxs)(j.y,{level:"1",weight:"bold",className:"wait-game-panel__room-code",children:["\u041a\u043e\u0434 \u0438\u0433\u0440\u044b: ",a.id]}),Object(x.jsx)(j.d,{level:"1",weight:"regular",className:"wait-game-panel__code-description",children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c \u044d\u0442\u0438\u043c \u043a\u043e\u0434\u043e\u043c \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u043a \u0432\u0430\u043c \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0438\u0441\u044c"}),Object(x.jsxs)(j.y,{level:"2",weight:"regular",className:"wait-game-panel__room-players",children:["\u0418\u0433\u0440\u043e\u043a\u043e\u0432: ",a.players.length,"/",a.playersNumber]})]})}),Object(x.jsx)(j.j,{header:Object(x.jsx)(j.k,{children:"\u0418\u0433\u0440\u043e\u043a\u0438"}),children:Object(x.jsx)(j.g,{children:a.players.map((function(e){return Object(x.jsx)(j.u,{before:Object(x.jsx)(j.b,{src:e.photoUrl}),children:e.name},e.id)}))})}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{mode:"commerce",size:"l",stretched:!0,disabled:!(a.players.length===a.playersNumber&&s.isHost),onClick:function(){X(a.id).then((function(e){t(m)})).catch((function(e){var t=e.response.data.message;d(t)}))},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),b&&Object(x.jsx)(ne,{errorMessage:b,closeSnackbar:function(){return d(null)}})]})}var le=c(160);function ie(e){var t=e.actions,c=void 0===t?[]:t;return Object(x.jsx)(x.Fragment,{children:c.map((function(e){return Object(x.jsx)(j.u,{before:Object(x.jsx)(j.b,{src:e.killedPlayer.photoUrl}),description:e.message,children:e.killedPlayer.name},e.id)}))})}var je=c(158),oe=c(159),ue=function(e){switch(e){case E:return"\u041c\u0430\u0444\u0438\u044f";case T:return"\u041a\u043e\u043c\u0438\u0441\u0441\u0430\u0440";case V:return"\u041c\u0438\u0440\u043d\u044b\u0439 \u0436\u0438\u0442\u0435\u043b\u044c";default:return"\u041a\u0430\u0440\u0442\u044b \u0441 \u0442\u0430\u043a\u0438\u043c \u0442\u0438\u043f\u043e\u043c \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"}},be=!0;function de(e){var t=e.player,c=Object(n.useState)(be),a=Object(i.a)(c,2),r=a[0],s=a[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u0422\u0432\u043e\u044f \u043a\u0430\u0440\u0442\u0430"})}),t.card&&Object(x.jsx)(j.u,{after:r?Object(x.jsx)(je.a,{onClick:function(){s(!1),be=!1}}):Object(x.jsx)(oe.a,{onClick:function(){s(!0),be=!0}}),children:r?ue(t.card.type):"\u041a\u0430\u0440\u0442\u0430 \u0441\u043a\u0440\u044b\u0442\u0430"})]})}var Oe=function(e){return e.players.filter((function(e){return e.status===K})).length},me=function(e,t){return e.players.find((function(e){return e.id===t}))},he=function(e){return e.votingPull.length},pe=function(e){return e.status!==q},fe=function(e){return e&&e.gameStatus===I},xe=(c(154),"MafiaWins"),ge="CivilWins";function ve(e){var t=e.setActivePanel,c=e.panelHeaderMessage,a=e.game,r=e.playerId,s=Object(n.useState)(me(a,r)),l=Object(i.a)(s,2),o=l[0],b=l[1],d=Object(n.useState)(null),O=Object(i.a)(d,2),m=O[0],h=O[1],p=Object(n.useState)(!1),f=Object(i.a)(p,2),g=f[0],v=f[1],y=Object(n.useState)(null),S=Object(i.a)(y,2),k=S[0],C=S[1],P=function(){h(null),t(u)},I=Object(x.jsxs)(j.n,{activeModal:m,children:[Object(x.jsx)(j.m,{id:xe,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u041f\u043e\u0431\u0435\u0434\u0438\u043b\u0430 \u043c\u0430\u0444\u0438\u044f",icon:Object(x.jsx)(le.a,{}),onClose:P,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:P,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(x.jsx)(j.m,{id:ge,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u041f\u043e\u0431\u0435\u0434\u0438\u043b\u0438 \u043c\u0438\u0440\u043d\u044b\u0435 \u0436\u0438\u0442\u0435\u043b\u0438",icon:Object(x.jsx)(le.a,{}),onClose:P,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:P,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})})]});return Object(n.useEffect)((function(){b(me(a,r))}),[a]),Object(n.useEffect)((function(){fe(a)&&a.result===D&&h(ge),fe(a)&&a.result===J&&h(xe)}),[a.result]),Object(n.useEffect)((function(){v(!1)}),[a.gamePhase]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:c}),Object(x.jsx)(j.x,{modal:I,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(de,{player:o}),Object(x.jsx)(j.t,{style:{margin:"12px 0"}}),Object(x.jsxs)(j.g,{children:[a.gamePhase===U&&Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){v(!0),Y(a.id,o.name).catch((function(e){var t=e.response.data.message;C(t)}))},disabled:!pe(o)||g,children:0===he(a)?"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0447\u044c":"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0447\u044c (\u0433\u043e\u043b\u043e\u0441\u043e\u0432 ".concat(he(a)," \u0438\u0437 ").concat(Oe(a),")")}),a.gamePhase===H&&Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){v(!0),ee(a.id,r).catch((function(e){var t=e.response.data.message;C(t)}))},disabled:!pe(o)||g,children:0===he(a)?"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u0443\u0434":"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u0443\u0434 (\u0433\u043e\u043b\u043e\u0441\u043e\u0432 ".concat(he(a)," \u0438\u0437 ").concat(Oe(a),")")})]}),pe(o)&&g&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),Object(x.jsx)(ie,{actions:a.actions})]})}),k&&Object(x.jsx)(ne,{errorMessage:k,closeSnackbar:function(){return C(null)}})]})}var ye=c(44),Se=function(e,t){return e.players.filter((function(e){return e.id!==t&&e.status!==q}))},ke=function(e){return e.card.type===E};function Ce(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,a=e.playerId,r=Object(n.useState)(me(c,a)),s=Object(i.a)(r,2),l=s[0],o=s[1],u=Object(n.useState)(Se(c,a)),b=Object(i.a)(u,2),d=b[0],O=(b[1],Object(n.useState)(!1)),m=Object(i.a)(O,2),h=m[0],p=m[1],f=Object(n.useState)(null),g=Object(i.a)(f,2),v=g[0],y=g[1],S=Object(n.useState)(null),k=Object(i.a)(S,2),C=k[0],P=k[1];return Object(ye.useEffect)((function(){o(me(c,a))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),ke(l)&&pe(l)&&!h&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u0443\u0431\u0438\u0442\u044c?"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){y(e.id===v?null:e.id)},checked:e.id===v,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===v,onClick:function(){p(!0),Z(c.id,l.name,v).catch((function(e){var t=e.response.data.message;P(t)}))},children:"\u0423\u0431\u0438\u0442\u044c"})})]}),ke(l)&&pe(l)&&h&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),ke(l)&&!pe(l)&&Object(x.jsx)(j.g,{children:"\u0412\u044b \u043c\u0435\u0440\u0442\u0432\u044b"}),!ke(l)&&Object(x.jsx)(j.g,{children:"\u0421\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u043d\u043e\u0447\u0438!"}),C&&Object(x.jsx)(ne,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}var Pe=c(161),Ie=function(e){return e.card.type===T},we="Mafia",Me="Civil";function He(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,a=e.playerId,r=Object(n.useState)(me(c,a)),s=Object(i.a)(r,2),l=s[0],o=s[1],u=Object(n.useState)(Se(c,a)),b=Object(i.a)(u,2),d=b[0],O=(b[1],Object(n.useState)(null)),m=Object(i.a)(O,2),h=m[0],p=m[1],f=Object(n.useState)(null),g=Object(i.a)(f,2),v=g[0],y=g[1],S=Object(n.useState)(null),k=Object(i.a)(S,2),C=k[0],P=k[1],I=function(){y(null),$(c.id).catch((function(e){var t=e.response.data.message;P(t)}))},w=Object(x.jsxs)(j.n,{activeModal:v,children:[Object(x.jsx)(j.m,{id:we,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u042d\u0442\u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u0430\u0444\u0438\u044f",icon:Object(x.jsx)(Pe.a,{}),onClose:I,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:I,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0445\u043e\u0434"})}),Object(x.jsx)(j.m,{id:Me,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u042d\u0442\u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u0438\u0440\u043d\u044b\u0439 \u0436\u0438\u0442\u0435\u043b\u044c",icon:Object(x.jsx)(Pe.a,{}),onClose:I,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:I,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0445\u043e\u0434"})})]});return Object(n.useEffect)((function(){o(me(c,a))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Ie(l)?Object(x.jsx)(j.x,{modal:w,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c?"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){p(e.id===h?null:e.id)},checked:e.id===h,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===h,onClick:function(){var e=d.find((function(e){return e.id===h}));e.card.type===E?y(we):y(Me)},children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c"})})]})}):Object(x.jsx)(j.g,{children:"\u0421\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u043d\u043e\u0447\u0438!"}),C&&Object(x.jsx)(ne,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}function Ae(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,a=e.playerId,r=Object(n.useState)(me(c,a)),s=Object(i.a)(r,2),l=s[0],o=s[1],u=Object(n.useState)(Se(c,a)),b=Object(i.a)(u,2),d=b[0],O=(b[1],Object(n.useState)(!1)),m=Object(i.a)(O,2),h=m[0],p=m[1],f=Object(n.useState)(null),g=Object(i.a)(f,2),v=g[0],y=g[1],S=Object(n.useState)(null),k=Object(i.a)(S,2),C=k[0],P=k[1];return Object(n.useEffect)((function(){o(me(c,a))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),pe(l)&&!h&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u043e\u0441\u0443\u0434\u0438\u0442\u044c??"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){y(e.id===v?null:e.id)},checked:e.id===v,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===v,onClick:function(){p(!0),te(c.id,a,v).catch((function(e){var t=e.response.data.message;P(t)}))},children:"\u041e\u0441\u0443\u0434\u0438\u0442\u044c"})})]}),pe(l)&&h&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),!pe(l)&&Object(x.jsx)(j.g,{children:"\u0412\u044b \u043c\u0435\u0440\u0442\u0432\u044b"}),C&&Object(x.jsx)(ne,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}var Ue=c(22),Ne=c.p+"static/media/playersSleep.c4c1ee3c.mp3",Fe=c.p+"static/media/playersWakeUp.8798fe3d.mp3",ze=c.p+"static/media/mafiaSleep.150eb60b.mp3",We=c.p+"static/media/mafiaWakeUp.3e03da91.mp3",Ge=c.p+"static/media/policeSleep.031070aa.mp3",_e=c.p+"static/media/policeWakeUp.2662b9d8.mp3",Ee={playersSleep:new Ue.Howl({src:[Ne]}),playersWakeUp:new Ue.Howl({src:[Fe]}),mafiaSleep:new Ue.Howl({src:[ze]}),mafiaWakeUp:new Ue.Howl({src:[We]}),policeSleep:new Ue.Howl({src:[Ge]}),policeWakeUp:new Ue.Howl({src:[_e]})};c(155);function Te(e){var t=e.setActivePanel,c=e.panelHeaderMessage,a=e.submitHasSeenIntro,r=Object(n.useState)(null),s=Object(i.a)(r,2),l=s[0],o=s[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:c}),Object(x.jsx)(j.x,{popout:l,children:Object(x.jsx)(j.w,{children:Object(x.jsxs)(j.j,{children:[Object(x.jsxs)(j.g,{children:[Object(x.jsx)(j.y,{level:"1",weight:"bold",className:"title-1",children:"\u041f\u0440\u0438\u0432\u0435\u0442! \ud83e\udd16"}),Object(x.jsx)(j.y,{level:"2",weight:"regular",className:"title-21",children:"\u0421 \u044d\u0442\u0438\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0442\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0438\u0433\u0440\u0430\u0442\u044c \u0432 \u043c\u0430\u0444\u0438\u044e \u0431\u0435\u0437 \u0432\u0435\u0434\u0443\u0449\u0435\u0433\u043e. \u0412\u0441\u0435 \u043a\u043e\u043c\u0430\u043d\u0434\u044b \u0431\u0443\u0434\u0435\u0442 \u043e\u0437\u0432\u0443\u0447\u0438\u0432\u0430\u0442\u044c \u0440\u043e\u0431\u043e\u0442-\u0430\u0441\u0441\u0438\u0441\u0442\u0435\u043d\u0442."}),Object(x.jsx)(j.y,{level:"2",weight:"regular",className:"title-22",children:"\u0420\u043e\u0431\u043e\u0442\u0430 \u0431\u0443\u0434\u0435\u0442 \u0441\u043b\u044b\u0448\u043d\u043e \u0438\u0437 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u043d\u043e \u0438\u0433\u0440\u043e\u043a\u0430 - \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f \u043a\u043e\u043c\u043d\u0430\u0442\u044b. \u0415\u0441\u043b\u0438 \u044d\u0442\u043e \u0442\u044b, \u0442\u043e \u0443\u0431\u0435\u0434\u0438\u0441\u044c, \u0447\u0442\u043e \u0437\u0432\u0443\u043a \u043d\u0430 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0435 \u0432\u043a\u043b\u044e\u0447\u0435\u043d!"})]}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{stretched:!0,size:"l",mode:"commerce",onClick:function(){o(Object(x.jsx)(j.s,{})),a().then((function(){t(u),o(null)}))},children:"\u041e\u041a"})})]})})})]})}var Ve=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)(null),s=Object(i.a)(r,2),v=s[0],y=s[1],S=Object(n.useState)(null),k=Object(i.a)(S,2),C=k[0],I=k[1],E=Object(n.useState)(null),T=Object(i.a)(E,2),V=T[0],K=T[1],q=Object(n.useState)("main"),J=Object(i.a)(q,2),D=J[0],L=(J[1],Object(n.useState)(u)),Q=Object(i.a)(L,2),X=Q[0],Y=Q[1],Z=Object(n.useState)(null),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ce=function(e){var t=setInterval((function(){R(e).then((function(e){a(e.data),K(e.data.gameAudioPhase)}))}),2e3);te(t)};return Object(n.useEffect)((function(){fe(c)&&(Y(m),clearInterval(ee),te(null)),(function(e){return e&&e.gameStatus===P&&e.gamePhase===U}(c)||function(e){return e&&e.gameStatus===P&&e.gamePhase===H}(c))&&Y(m),function(e){return e&&e.gameStatus===P&&e.gamePhase===w}(c)&&Y(h),function(e){return e&&e.gameStatus===P&&e.gamePhase===M}(c)&&Y(p),function(e){return e&&e.gameStatus===P&&e.gamePhase===A}(c)&&Y(f)}),[c]),Object(n.useEffect)((function(){if(c&&(me(c,v).isHost&&(null!==V||void 0!==V)))switch(V){case z:Ee.mafiaSleep.play();break;case W:Ee.mafiaWakeUp.play();break;case N:Ee.playersSleep.play();break;case F:Ee.playersWakeUp.play();break;case G:Ee.policeSleep.play();break;case _:Ee.policeWakeUp.play()}}),[V]),Object(n.useEffect)((function(){B(),l.a.send("VKWebAppGetUserInfo").then((function(e){I(e.photo_200)})),l.a.send("VKWebAppStorageGet",{keys:["hasSeenIntro"]}).then((function(e){e.keys[0].value||Y(o)}))}),[]),Object(n.useEffect)((function(){X===u&&ee&&(clearInterval(ee),te(null))}),[X]),Object(x.jsx)(j.a,{children:Object(x.jsx)(j.r,{activeView:D,children:Object(x.jsxs)(j.z,{activePanel:X,id:"main",children:[Object(x.jsx)(j.o,{centered:!0,id:o,children:Object(x.jsx)(Te,{setActivePanel:Y,panelHeaderMessage:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!",submitHasSeenIntro:function(){return l.a.send("VKWebAppStorageSet",{key:"hasSeenIntro",value:"1"})}})}),Object(x.jsx)(j.o,{centered:!0,id:u,className:"home-panel",children:Object(x.jsx)(g,{setActivePanel:Y,panelHeaderMessage:"\u041c\u0430\u0444\u0438\u044f"})}),Object(x.jsx)(j.o,{id:b,className:"create-game-panel",children:Object(x.jsx)(ae,{setActivePanel:Y,setGame:a,setPlayerId:y,subscribeToGame:ce,panelHeaderMessage:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443",playerPhotoUrl:C})}),Object(x.jsx)(j.o,{id:d,children:Object(x.jsx)(re,{setActivePanel:Y,setGame:a,setPlayerId:y,subscribeToGame:ce,panelHeaderMessage:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0438\u0433\u0440\u0435",playerPhotoUrl:C})}),Object(x.jsx)(j.o,{id:O,children:Object(x.jsx)(se,{setActivePanel:Y,panelHeaderMessage:"\u0416\u0434\u0435\u043c \u0432\u0441\u0435\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:m,children:Object(x.jsx)(ve,{setActivePanel:Y,panelHeaderMessage:"\u0418\u0433\u0440\u0430",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:h,children:Object(x.jsx)(Ce,{setActivePanel:Y,panelHeaderMessage:"\u041d\u043e\u0447\u044c: \u0445\u043e\u0434 \u041c\u0430\u0444\u0438\u0438",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:p,children:Object(x.jsx)(He,{setActivePanel:Y,panelHeaderMessage:"\u041d\u043e\u0447\u044c: \u0445\u043e\u0434 \u041a\u043e\u043c\u0438\u0441\u0441\u0430\u0440\u0430",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:f,children:Object(x.jsx)(Ae,{setActivePanel:Y,panelHeaderMessage:"\u0421\u0443\u0434",game:c,playerId:v})})]})})})};l.a.send("VKWebAppInit"),r.a.render(Object(x.jsx)(Ve,{}),document.getElementById("root"))}},[[156,1,2]]]);
//# sourceMappingURL=main.ae685a6b.chunk.js.map