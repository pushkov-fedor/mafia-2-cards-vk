(this.webpackJsonpmafia_vk_mini_app=this.webpackJsonpmafia_vk_mini_app||[]).push([[0],{133:function(e,t,c){},153:function(e,t,c){},154:function(e,t,c){},155:function(e,t,c){"use strict";c.r(t);var a=c(0),n=c(29),r=c.n(n),s=c(17),l=c.n(s),i=c(7),j=c(2),o=(c(132),c(133),"Intro"),u="Home",b="CreateGame",d="JoinGame",O="WaitGame",m="Game",h="Mafia",p="Police",f="Civils",x=c(1);function g(e){var t=e.setActivePanel,c=e.panelHeaderMessage;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:c}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){return t(b)},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){return t(d)},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})}var v=c(25),y=c(26),S=c(18),k=c.n(S),C="https://mafia2cards.herokuapp.com/api",P=1,I=2,M=0,w=1,H=2,U=3,A=4,F=0,N=1,z=2,W=3,G=4,_=5,E=0,T=1,V=2,q=0,K=2,J=0,D=1,B=function(e,t,c,a,n){return k.a.post("".concat(C,"/game2/create"),{creatorName:e,playerPhotoUrl:t,civilsNumber:c,mafiaNumber:a,hasPolice:n})},L=function(e,t,c){return k.a.post("".concat(C,"/game2/join"),{playerName:e,playerPhotoUrl:t,gameId:c})},Q=function(e){return k.a.get("".concat(C,"/game2/get/").concat(e))},R=function(e){return k.a.post("".concat(C,"/game2/start"),{gameId:e})},X=function(e,t){return k.a.post("".concat(C,"/game2/startNight"),{gameId:e,playerId:t})},Y=function(e,t,c){return k.a.post("".concat(C,"/game2/mafiaKill"),{gameId:e,playerId:t,playerVoteValue:c})},Z=function(e){return k.a.post("".concat(C,"/game2/endNight"),{gameId:e})},$=function(e,t){return k.a.post("".concat(C,"/game2/startTrial"),{gameId:e,playerId:t})},ee=function(e,t,c){return k.a.post("".concat(C,"/game2/civilsKill"),{gameId:e,playerId:t,playerVoteValue:c})},te=c(156);function ce(e){var t=e.closeSnackbar,c=e.errorMessage;return Object(x.jsx)(j.v,{onClose:t,before:Object(x.jsx)(te.a,{}),children:c})}function ae(e){var t=e.setActivePanel,c=e.setGame,n=e.setPlayerId,r=e.subscribeToGame,s=e.panelHeaderMessage,l=e.playerPhotoUrl,o=Object(a.useState)(""),b=Object(i.a)(o,2),d=b[0],m=b[1],h=Object(a.useState)(5),p=Object(i.a)(h,2),f=p[0],g=p[1],S=Object(a.useState)(1),k=Object(i.a)(S,2),C=k[0],P=k[1],I=Object(a.useState)(!1),M=Object(i.a)(I,2),w=M[0],H=M[1],U=Object(a.useState)({name:!1,numberOfCivils:!1,numberOfMafia:!1}),A=Object(i.a)(U,2),F=A[0],N=A[1],z=Object(a.useState)(null),W=Object(i.a)(z,2),G=W[0],_=W[1],E=Object(a.useState)(null),T=Object(i.a)(E,2),V=T[0],q=T[1],K=Object(a.useState)("valid"),J=Object(i.a)(K,2),D=J[0],L=J[1],Q=Object(a.useState)(""),R=Object(i.a)(Q,2),X=R[0],Y=R[1],Z=Object(a.useState)("valid"),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ae=Object(a.useState)(""),ne=Object(i.a)(ae,2),re=ne[0],se=ne[1],le=function(e){N(Object(y.a)(Object(y.a)({},F),{},Object(v.a)({},e,!0)))};return Object(a.useEffect)((function(){var e=Number(C),t=Number(f),c=!1,a=!1;e<1&&(L("error"),Y("\u041c\u0430\u0444\u0438\u0438 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 0"),c=!0),t<3&&(te("error"),se("\u041c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 2"),a=!0),e===t&&(L("error"),Y("\u041c\u0430\u0444\u0438\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u0442\u043e\u043b\u044c\u043a\u043e \u0436\u0435, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439"),c=!0),e>t&&(L("error"),Y("\u041c\u0430\u0444\u0438\u0438 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439"),c=!0),c||(L("valid"),Y("")),a||(te("valid"),se(""))}),[C,f]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:s}),Object(x.jsx)(j.x,{popout:V,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.i,{onSubmit:function(e){e.preventDefault()},children:[Object(x.jsx)(j.h,{top:"\u0418\u043c\u044f",status:d?"valid":F.name?"error":"default",bottom:!d&&F.name?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"name",value:d,onChange:function(e){m(e.currentTarget.value)},onFocus:function(e){return le("name")},placeholder:"\u041c\u043e\u0435 \u0438\u043c\u044f"})}),Object(x.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439",status:ee,bottom:re,children:Object(x.jsx)(j.l,{type:"number",name:"numberOfCivils",value:f,onChange:function(e){g(e.target.value)},onFocus:function(e){return le("numberOfCivils")}})}),Object(x.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0444\u0438\u0438",status:D,bottom:X,children:Object(x.jsx)(j.l,{type:"number",name:"numberOfMafia",value:C,onChange:function(e){P(e.currentTarget.value)},onFocus:function(e){return le("numberOfMafia")}})}),Object(x.jsx)(j.f,{value:w,onChange:function(e){return H(e.currentTarget.checked)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u0438\u0441\u0441\u0430\u0440\u0430"}),Object(x.jsx)(j.h,{children:Object(x.jsx)(j.c,{mode:"commerce",type:"submit",stretched:!0,size:"l",disabled:!d||"error"===ee||"error"===D,onClick:function(){q(Object(x.jsx)(j.s,{})),B(d,l,Number(f),Number(C),w).then((function(e){c(e.data.game),n(e.data.playerId),r(e.data.game.id),t(O)})).catch((function(e){var t=e.response.data.message;_(t)})).finally((function(){q(null)}))},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})})]})}),G&&Object(x.jsx)(ce,{errorMessage:G,closeSnackbar:function(){return _(null)}})]})})]})}function ne(e){var t=e.setActivePanel,c=e.setGame,n=e.setPlayerId,r=e.subscribeToGame,s=e.panelHeaderMessage,l=e.playerPhotoUrl,o=Object(a.useState)(""),b=Object(i.a)(o,2),d=b[0],h=b[1],p=Object(a.useState)(""),f=Object(i.a)(p,2),g=f[0],S=f[1],k=Object(a.useState)({roomCode:!1,name:!1}),C=Object(i.a)(k,2),I=C[0],M=C[1],w=Object(a.useState)(null),H=Object(i.a)(w,2),U=H[0],A=H[1],F=Object(a.useState)(null),N=Object(i.a)(F,2),z=N[0],W=N[1],G=function(e){M(Object(y.a)(Object(y.a)({},I),{},Object(v.a)({},e,!0)))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:s}),Object(x.jsx)(j.x,{popout:z,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.i,{onSubmit:function(e){e.preventDefault()},children:[Object(x.jsx)(j.h,{top:"\u041a\u043e\u0434 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",status:d?"valid":I.roomCode?"error":"default",bottom:!d&&I.roomCode?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"roomCode",value:d,onChange:function(e){h(e.currentTarget.value.toUpperCase())},onFocus:function(e){return G("roomCode")},placeholder:"MF12P5"})}),Object(x.jsx)(j.h,{top:"\u0418\u043c\u044f",status:g?"valid":I.name?"error":"default",bottom:!g&&I.name?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"name",value:g,onChange:function(e){S(e.currentTarget.value)},onFocus:function(e){return G("name")},placeholder:"\u0422\u0432\u043e\u0435 \u0438\u043c\u044f"})}),Object(x.jsx)(j.h,{children:Object(x.jsx)(j.c,{mode:"commerce",type:"submit",stretched:!0,size:"l",disabled:!d||!g,onClick:function(){W(Object(x.jsx)(j.s,{})),L(g,l,d).then((function(e){c(e.data.game),n(e.data.playerId),r(e.data.game.id),e.data.game.gameStatus!==P?t(O):t(m)})).catch((function(e){var t=e.response.data.message;A(t)})).finally((function(){W(null)}))},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})}),U&&Object(x.jsx)(ce,{errorMessage:U,closeSnackbar:function(){return A(null)}})]})})]})}c(153);function re(e){var t=e.setActivePanel,c=e.panelHeaderMessage,n=e.game,r=e.playerId,s=n.players.find((function(e){return e.id===r})),l=Object(a.useState)(null),o=Object(i.a)(l,2),b=o[0],d=o[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:c}),Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.g,{children:[Object(x.jsxs)(j.y,{level:"1",weight:"bold",className:"wait-game-panel__room-code",children:["\u041a\u043e\u0434 \u0438\u0433\u0440\u044b: ",n.id]}),Object(x.jsx)(j.d,{level:"1",weight:"regular",className:"wait-game-panel__code-description",children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c \u044d\u0442\u0438\u043c \u043a\u043e\u0434\u043e\u043c \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u043a \u0432\u0430\u043c \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0438\u0441\u044c"}),Object(x.jsxs)(j.y,{level:"2",weight:"regular",className:"wait-game-panel__room-players",children:["\u0418\u0433\u0440\u043e\u043a\u043e\u0432: ",n.players.length,"/",n.playersNumber]})]})}),Object(x.jsx)(j.j,{header:Object(x.jsx)(j.k,{children:"\u0418\u0433\u0440\u043e\u043a\u0438"}),children:Object(x.jsx)(j.g,{children:n.players.map((function(e){return Object(x.jsx)(j.u,{before:Object(x.jsx)(j.b,{src:e.photoUrl}),children:e.name},e.id)}))})}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{mode:"commerce",size:"l",stretched:!0,disabled:!(n.players.length===n.playersNumber&&s.isHost),onClick:function(){R(n.id).then((function(e){t(m)})).catch((function(e){var t=e.response.data.message;d(t)}))},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),b&&Object(x.jsx)(ce,{errorMessage:b,closeSnackbar:function(){return d(null)}})]})}var se=c(159);function le(e){var t=e.actions,c=void 0===t?[]:t;return Object(x.jsx)(x.Fragment,{children:c.map((function(e){return Object(x.jsx)(j.u,{before:Object(x.jsx)(j.b,{src:e.killedPlayer.photoUrl}),description:e.message,children:e.killedPlayer.name},e.id)}))})}var ie=c(157),je=c(158),oe=function(e){switch(e){case E:return"\u041c\u0430\u0444\u0438\u044f";case T:return"\u041a\u043e\u043c\u0438\u0441\u0441\u0430\u0440";case V:return"\u041c\u0438\u0440\u043d\u044b\u0439 \u0436\u0438\u0442\u0435\u043b\u044c";default:return"\u041a\u0430\u0440\u0442\u044b \u0441 \u0442\u0430\u043a\u0438\u043c \u0442\u0438\u043f\u043e\u043c \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"}},ue=!0;function be(e){var t=e.player,c=Object(a.useState)(ue),n=Object(i.a)(c,2),r=n[0],s=n[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u0422\u0432\u043e\u044f \u043a\u0430\u0440\u0442\u0430"})}),t.card&&Object(x.jsx)(j.u,{after:r?Object(x.jsx)(ie.a,{onClick:function(){s(!1),ue=!1}}):Object(x.jsx)(je.a,{onClick:function(){s(!0),ue=!0}}),children:r?oe(t.card.type):"\u041a\u0430\u0440\u0442\u0430 \u0441\u043a\u0440\u044b\u0442\u0430"})]})}var de=function(e){return e.players.filter((function(e){return e.status===q})).length},Oe=function(e,t){return e.players.find((function(e){return e.id===t}))},me=function(e){return e.votingPull.length},he=function(e){return e.status!==K},pe=function(e){return e&&e.gameStatus===I},fe=(c(154),"MafiaWins"),xe="CivilWins";function ge(e){var t=e.setActivePanel,c=e.panelHeaderMessage,n=e.game,r=e.playerId,s=Object(a.useState)(Oe(n,r)),l=Object(i.a)(s,2),o=l[0],b=l[1],d=Object(a.useState)(null),O=Object(i.a)(d,2),m=O[0],h=O[1],p=Object(a.useState)(!1),f=Object(i.a)(p,2),g=f[0],v=f[1],y=Object(a.useState)(null),S=Object(i.a)(y,2),k=S[0],C=S[1],P=function(){h(null),t(u)},I=Object(x.jsxs)(j.n,{activeModal:m,children:[Object(x.jsx)(j.m,{id:fe,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u041f\u043e\u0431\u0435\u0434\u0438\u043b\u0430 \u043c\u0430\u0444\u0438\u044f",icon:Object(x.jsx)(se.a,{}),onClose:P,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:P,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(x.jsx)(j.m,{id:xe,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u041f\u043e\u0431\u0435\u0434\u0438\u043b\u0438 \u043c\u0438\u0440\u043d\u044b\u0435 \u0436\u0438\u0442\u0435\u043b\u0438",icon:Object(x.jsx)(se.a,{}),onClose:P,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:P,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})})]});return Object(a.useEffect)((function(){b(Oe(n,r))}),[n]),Object(a.useEffect)((function(){pe(n)&&n.result===D&&h(xe),pe(n)&&n.result===J&&h(fe)}),[n.result]),Object(a.useEffect)((function(){v(!1)}),[n.gamePhase]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:c}),Object(x.jsx)(j.x,{modal:I,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(be,{player:o}),Object(x.jsx)(j.t,{style:{margin:"12px 0"}}),Object(x.jsxs)(j.g,{children:[n.gamePhase===A&&Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){v(!0),X(n.id,o.name).catch((function(e){var t=e.response.data.message;C(t)}))},disabled:!he(o)||g,children:0===me(n)?"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0447\u044c":"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0447\u044c (\u0433\u043e\u043b\u043e\u0441\u043e\u0432 ".concat(me(n)," \u0438\u0437 ").concat(de(n),")")}),n.gamePhase===H&&Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){v(!0),$(n.id,r).catch((function(e){var t=e.response.data.message;C(t)}))},disabled:!he(o)||g,children:0===me(n)?"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u0443\u0434":"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u0443\u0434 (\u0433\u043e\u043b\u043e\u0441\u043e\u0432 ".concat(me(n)," \u0438\u0437 ").concat(de(n),")")})]}),he(o)&&g&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),Object(x.jsx)(le,{actions:n.actions})]})}),k&&Object(x.jsx)(ce,{errorMessage:k,closeSnackbar:function(){return C(null)}})]})}var ve=c(44),ye=function(e,t){return e.players.filter((function(e){return e.id!==t&&e.status!==K}))},Se=function(e){return e.card.type===E};function ke(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,n=e.playerId,r=Object(a.useState)(Oe(c,n)),s=Object(i.a)(r,2),l=s[0],o=s[1],u=Object(a.useState)(ye(c,n)),b=Object(i.a)(u,2),d=b[0],O=(b[1],Object(a.useState)(!1)),m=Object(i.a)(O,2),h=m[0],p=m[1],f=Object(a.useState)(null),g=Object(i.a)(f,2),v=g[0],y=g[1],S=Object(a.useState)(null),k=Object(i.a)(S,2),C=k[0],P=k[1];return Object(ve.useEffect)((function(){o(Oe(c,n))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Se(l)&&he(l)&&!h&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u0443\u0431\u0438\u0442\u044c?"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){y(e.id===v?null:e.id)},checked:e.id===v,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===v,onClick:function(){p(!0),Y(c.id,l.name,v).catch((function(e){var t=e.response.data.message;P(t)}))},children:"\u0423\u0431\u0438\u0442\u044c"})})]}),Se(l)&&he(l)&&h&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),Se(l)&&!he(l)&&Object(x.jsx)(j.g,{children:"\u0412\u044b \u043c\u0435\u0440\u0442\u0432\u044b"}),!Se(l)&&Object(x.jsx)(j.g,{children:"\u0421\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u043d\u043e\u0447\u0438!"}),C&&Object(x.jsx)(ce,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}var Ce=c(160),Pe=function(e){return e.card.type===T},Ie="Mafia",Me="Civil";function we(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,n=e.playerId,r=Object(a.useState)(Oe(c,n)),s=Object(i.a)(r,2),l=s[0],o=s[1],u=Object(a.useState)(ye(c,n)),b=Object(i.a)(u,2),d=b[0],O=(b[1],Object(a.useState)(null)),m=Object(i.a)(O,2),h=m[0],p=m[1],f=Object(a.useState)(null),g=Object(i.a)(f,2),v=g[0],y=g[1],S=Object(a.useState)(null),k=Object(i.a)(S,2),C=k[0],P=k[1],I=function(){y(null),Z(c.id).catch((function(e){var t=e.response.data.message;P(t)}))},M=Object(x.jsxs)(j.n,{activeModal:v,children:[Object(x.jsx)(j.m,{id:Ie,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u042d\u0442\u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u0430\u0444\u0438\u044f",icon:Object(x.jsx)(Ce.a,{}),onClose:I,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:I,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0445\u043e\u0434"})}),Object(x.jsx)(j.m,{id:Me,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u042d\u0442\u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u0438\u0440\u043d\u044b\u0439 \u0436\u0438\u0442\u0435\u043b\u044c",icon:Object(x.jsx)(Ce.a,{}),onClose:I,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:I,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0445\u043e\u0434"})})]});return Object(a.useEffect)((function(){o(Oe(c,n))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Pe(l)?Object(x.jsx)(j.x,{modal:M,children:Object(x.jsxs)(j.w,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c?"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){p(e.id===h?null:e.id)},checked:e.id===h,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===h,onClick:function(){var e=d.find((function(e){return e.id===h}));e.card.type===E?y(Ie):y(Me)},children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c"})})]})}):Object(x.jsx)(j.g,{children:"\u0421\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u043d\u043e\u0447\u0438!"}),C&&Object(x.jsx)(ce,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}function He(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,n=e.playerId,r=Object(a.useState)(Oe(c,n)),s=Object(i.a)(r,2),l=s[0],o=s[1],u=Object(a.useState)(ye(c,n)),b=Object(i.a)(u,2),d=b[0],O=(b[1],Object(a.useState)(!1)),m=Object(i.a)(O,2),h=m[0],p=m[1],f=Object(a.useState)(null),g=Object(i.a)(f,2),v=g[0],y=g[1],S=Object(a.useState)(null),k=Object(i.a)(S,2),C=k[0],P=k[1];return Object(a.useEffect)((function(){o(Oe(c,n))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),he(l)&&!h&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.y,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u043e\u0441\u0443\u0434\u0438\u0442\u044c??"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){y(e.id===v?null:e.id)},checked:e.id===v,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===v,onClick:function(){p(!0),ee(c.id,n,v).catch((function(e){var t=e.response.data.message;P(t)}))},children:"\u041e\u0441\u0443\u0434\u0438\u0442\u044c"})})]}),he(l)&&h&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),!he(l)&&Object(x.jsx)(j.g,{children:"\u0412\u044b \u043c\u0435\u0440\u0442\u0432\u044b"}),C&&Object(x.jsx)(ce,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}var Ue=c(22),Ae=c.p+"static/media/playersSleep.c4c1ee3c.mp3",Fe=c.p+"static/media/playersWakeUp.8798fe3d.mp3",Ne=c.p+"static/media/mafiaSleep.150eb60b.mp3",ze=c.p+"static/media/mafiaWakeUp.3e03da91.mp3",We=c.p+"static/media/policeSleep.031070aa.mp3",Ge=c.p+"static/media/policeWakeUp.2662b9d8.mp3",_e={playersSleep:new Ue.Howl({src:[Ae]}),playersWakeUp:new Ue.Howl({src:[Fe]}),mafiaSleep:new Ue.Howl({src:[Ne]}),mafiaWakeUp:new Ue.Howl({src:[ze]}),policeSleep:new Ue.Howl({src:[We]}),policeWakeUp:new Ue.Howl({src:[Ge]})};function Ee(e){e.setActivePanel;var t=e.panelHeaderMessage;e.hasSeenIntro;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Object(x.jsx)(j.g,{children:"123"})]})}var Te=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),c=t[0],n=t[1],r=Object(a.useState)(null),s=Object(i.a)(r,2),v=s[0],y=s[1],S=Object(a.useState)(null),k=Object(i.a)(S,2),C=k[0],I=k[1],E=Object(a.useState)(null),T=Object(i.a)(E,2),V=T[0],q=T[1],K=Object(a.useState)("main"),J=Object(i.a)(K,2),D=J[0],B=(J[1],Object(a.useState)(u)),L=Object(i.a)(B,2),R=L[0],X=L[1],Y=Object(a.useState)(null),Z=Object(i.a)(Y,2),$=Z[0],ee=Z[1],te=function(e){var t=setInterval((function(){Q(e).then((function(e){n(e.data),q(e.data.gameAudioPhase)}))}),2e3);ee(t)};return Object(a.useEffect)((function(){pe(c)&&(X(m),clearInterval($),ee(null)),(function(e){return e&&e.gameStatus===P&&e.gamePhase===A}(c)||function(e){return e&&e.gameStatus===P&&e.gamePhase===H}(c))&&X(m),function(e){return e&&e.gameStatus===P&&e.gamePhase===M}(c)&&X(h),function(e){return e&&e.gameStatus===P&&e.gamePhase===w}(c)&&X(p),function(e){return e&&e.gameStatus===P&&e.gamePhase===U}(c)&&X(f)}),[c]),Object(a.useEffect)((function(){if(c&&(Oe(c,v).isHost&&(null!==V||void 0!==V)))switch(V){case z:_e.mafiaSleep.play();break;case W:_e.mafiaWakeUp.play();break;case F:_e.playersSleep.play();break;case N:_e.playersWakeUp.play();break;case G:_e.policeSleep.play();break;case _:_e.policeWakeUp.play()}}),[V]),Object(a.useEffect)((function(){l.a.send("VKWebAppGetUserInfo").then((function(e){I(e.photo_200)}))}),[]),Object(a.useEffect)((function(){R===u&&$&&(clearInterval($),ee(null))}),[R]),Object(x.jsx)(j.a,{children:Object(x.jsx)(j.r,{activeView:D,children:Object(x.jsxs)(j.z,{activePanel:R,id:"main",children:[Object(x.jsx)(j.o,{id:o,children:Object(x.jsx)(Ee,{setActivePanel:X,panelHeaderMessage:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!"})}),Object(x.jsx)(j.o,{centered:!0,id:u,className:"home-panel",children:Object(x.jsx)(g,{setActivePanel:X,panelHeaderMessage:"\u041c\u0430\u0444\u0438\u044f"})}),Object(x.jsx)(j.o,{id:b,className:"create-game-panel",children:Object(x.jsx)(ae,{setActivePanel:X,setGame:n,setPlayerId:y,subscribeToGame:te,panelHeaderMessage:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443",playerPhotoUrl:C})}),Object(x.jsx)(j.o,{id:d,children:Object(x.jsx)(ne,{setActivePanel:X,setGame:n,setPlayerId:y,subscribeToGame:te,panelHeaderMessage:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0438\u0433\u0440\u0435",playerPhotoUrl:C})}),Object(x.jsx)(j.o,{id:O,children:Object(x.jsx)(re,{setActivePanel:X,panelHeaderMessage:"\u0416\u0434\u0435\u043c \u0432\u0441\u0435\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:m,children:Object(x.jsx)(ge,{setActivePanel:X,panelHeaderMessage:"\u0418\u0433\u0440\u0430",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:h,children:Object(x.jsx)(ke,{setActivePanel:X,panelHeaderMessage:"\u041d\u043e\u0447\u044c: \u0445\u043e\u0434 \u041c\u0430\u0444\u0438\u0438",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:p,children:Object(x.jsx)(we,{setActivePanel:X,panelHeaderMessage:"\u041d\u043e\u0447\u044c: \u0445\u043e\u0434 \u041a\u043e\u043c\u0438\u0441\u0441\u0430\u0440\u0430",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:f,children:Object(x.jsx)(He,{setActivePanel:X,panelHeaderMessage:"\u0421\u0443\u0434",game:c,playerId:v})})]})})})};l.a.send("VKWebAppInit"),r.a.render(Object(x.jsx)(Te,{}),document.getElementById("root"))}},[[155,1,2]]]);
//# sourceMappingURL=main.5b88ce09.chunk.js.map