(this.webpackJsonpmafia_vk_mini_app=this.webpackJsonpmafia_vk_mini_app||[]).push([[0],{135:function(e,t,c){},155:function(e,t,c){},156:function(e,t,c){},157:function(e,t,c){"use strict";c.r(t);var n=c(0),a=c(29),r=c.n(a),s=c(17),i=c.n(s),l=c(10),j=c(2),o=(c(134),c(135),"Intro"),u="Home",b="CreateGame",d="JoinGame",O="WaitGame",m="Game",h="Mafia",f="Police",p="Civils",x=c(1);function g(e){var t=e.setActivePanel,c=e.panelHeaderMessage;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:c}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){return t(b)},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){return t(d)},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})}var v=c(25),y=c(26),S=c(18),k=c.n(S),C="https://mafia2cards.herokuapp.com/api",P=1,M=2,I=0,w=1,H=2,U=3,A=4,F=0,N=1,z=2,W=3,G=4,_=5,E=0,T=1,V=2,q=0,K=2,J=0,D=1,B=function(e,t,c,n,a){return k.a.post("".concat(C,"/game2/create"),{creatorName:e,playerPhotoUrl:t,civilsNumber:c,mafiaNumber:n,hasPolice:a})},L=function(e,t,c){return k.a.post("".concat(C,"/game2/join"),{playerName:e,playerPhotoUrl:t,gameId:c})},Q=function(e){return k.a.get("".concat(C,"/game2/get/").concat(e))},R=function(e){return k.a.post("".concat(C,"/game2/start"),{gameId:e})},X=function(e,t){return k.a.post("".concat(C,"/game2/startNight"),{gameId:e,playerId:t})},Y=function(e,t,c){return k.a.post("".concat(C,"/game2/mafiaKill"),{gameId:e,playerId:t,playerVoteValue:c})},Z=function(e){return k.a.post("".concat(C,"/game2/endNight"),{gameId:e})},$=function(e,t){return k.a.post("".concat(C,"/game2/startTrial"),{gameId:e,playerId:t})},ee=function(e,t,c){return k.a.post("".concat(C,"/game2/civilsKill"),{gameId:e,playerId:t,playerVoteValue:c})},te=c(158);function ce(e){var t=e.closeSnackbar,c=e.errorMessage;return Object(x.jsx)(j.u,{onClose:t,before:Object(x.jsx)(te.a,{}),children:c})}function ne(e){var t=e.setActivePanel,c=e.setGame,a=e.setPlayerId,r=e.subscribeToGame,s=e.panelHeaderMessage,i=e.playerPhotoUrl,o=Object(n.useState)(""),b=Object(l.a)(o,2),d=b[0],m=b[1],h=Object(n.useState)(5),f=Object(l.a)(h,2),p=f[0],g=f[1],S=Object(n.useState)(1),k=Object(l.a)(S,2),C=k[0],P=k[1],M=Object(n.useState)(!1),I=Object(l.a)(M,2),w=I[0],H=I[1],U=Object(n.useState)({name:!1,numberOfCivils:!1,numberOfMafia:!1}),A=Object(l.a)(U,2),F=A[0],N=A[1],z=Object(n.useState)(null),W=Object(l.a)(z,2),G=W[0],_=W[1],E=function(e){N(Object(y.a)(Object(y.a)({},F),{},Object(v.a)({},e,!0)))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:s}),Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.i,{onSubmit:function(e){e.preventDefault()},children:[Object(x.jsx)(j.h,{top:"\u0418\u043c\u044f",status:d?"valid":F.name?"error":"default",bottom:!d&&F.name?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"name",value:d,onChange:function(e){m(e.currentTarget.value)},onFocus:function(e){return E("name")},placeholder:"\u041c\u043e\u0435 \u0438\u043c\u044f"})}),Object(x.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0438\u0440\u043d\u044b\u0445 \u0436\u0438\u0442\u0435\u043b\u0435\u0439",status:p?"valid":F.numberOfCivils?"error":"default",bottom:!p&&F.numberOfCivils?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"number",name:"numberOfCivils",value:p,onChange:function(e){g(e.currentTarget.value)},onFocus:function(e){return E("numberOfCivils")}})}),Object(x.jsx)(j.h,{top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0444\u0438\u0438",status:C?"valid":F.numberOfMafia?"error":"default",bottom:!C&&F.numberOfMafia?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"number",name:"numberOfMafia",value:C,onChange:function(e){P(e.currentTarget.value)},onFocus:function(e){return E("numberOfMafia")}})}),Object(x.jsx)(j.f,{value:w,onChange:function(e){return H(e.currentTarget.checked)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u0438\u0441\u0441\u0430\u0440\u0430"}),Object(x.jsx)(j.h,{children:Object(x.jsx)(j.c,{mode:"commerce",type:"submit",stretched:!0,size:"l",disabled:!d||!p||!C,onClick:function(){B(d,i,Number(p),Number(C),w).then((function(e){c(e.data.game),a(e.data.playerId),r(e.data.game.id),t(O)})).catch((function(e){return _(e)}))},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})})]})}),G&&Object(x.jsx)(ce,{errorMessage:G,closeSnackbar:function(){return _(null)}})]})}function ae(e){var t=e.setActivePanel,c=e.setGame,a=e.setPlayerId,r=e.subscribeToGame,s=e.panelHeaderMessage,i=e.playerPhotoUrl,o=Object(n.useState)(""),b=Object(l.a)(o,2),d=b[0],h=b[1],f=Object(n.useState)(""),p=Object(l.a)(f,2),g=p[0],S=p[1],k=Object(n.useState)({roomCode:!1,name:!1}),C=Object(l.a)(k,2),M=C[0],I=C[1],w=Object(n.useState)(null),H=Object(l.a)(w,2),U=H[0],A=H[1],F=function(e){I(Object(y.a)(Object(y.a)({},M),{},Object(v.a)({},e,!0)))};return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:s}),Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.i,{onSubmit:function(e){e.preventDefault()},children:[Object(x.jsx)(j.h,{top:"\u041a\u043e\u0434 \u043a\u043e\u043c\u043d\u0430\u0442\u044b",status:d?"valid":M.roomCode?"error":"default",bottom:!d&&M.roomCode?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"roomCode",value:d,onChange:function(e){h(e.currentTarget.value.toUpperCase())},onFocus:function(e){return F("roomCode")},placeholder:"MF12P5"})}),Object(x.jsx)(j.h,{top:"\u0418\u043c\u044f",status:g?"valid":M.name?"error":"default",bottom:!g&&M.name?"\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435":"",children:Object(x.jsx)(j.l,{type:"text",name:"name",value:g,onChange:function(e){S(e.currentTarget.value)},onFocus:function(e){return F("name")},placeholder:"\u0422\u0432\u043e\u0435 \u0438\u043c\u044f"})}),Object(x.jsx)(j.h,{children:Object(x.jsx)(j.c,{mode:"commerce",type:"submit",stretched:!0,size:"l",disabled:!d||!g,onClick:function(){L(g,i,d).then((function(e){console.log(e),c(e.data.game),a(e.data.playerId),r(e.data.game.id),e.data.game.gameStatus!==P?t(O):t(m)})).catch((function(e){var t=e.response.data.message;A(t)}))},children:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"})})]})}),U&&Object(x.jsx)(ce,{errorMessage:U,closeSnackbar:function(){return A(null)}})]})}c(155);function re(e){var t=e.setActivePanel,c=e.panelHeaderMessage,a=e.game,r=e.playerId,s=a.players.find((function(e){return e.id===r})),i=Object(n.useState)(null),o=Object(l.a)(i,2),b=o[0],d=o[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:c}),Object(x.jsx)(j.j,{children:Object(x.jsxs)(j.g,{children:[Object(x.jsxs)(j.x,{level:"1",weight:"bold",className:"wait-game-panel__room-code",children:["\u041a\u043e\u0434 \u0438\u0433\u0440\u044b: ",a.id]}),Object(x.jsx)(j.d,{level:"1",weight:"regular",className:"wait-game-panel__code-description",children:"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c \u044d\u0442\u0438\u043c \u043a\u043e\u0434\u043e\u043c \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u043d\u0438 \u043a \u0432\u0430\u043c \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0438\u0441\u044c"}),Object(x.jsxs)(j.x,{level:"2",weight:"regular",className:"wait-game-panel__room-players",children:["\u0418\u0433\u0440\u043e\u043a\u043e\u0432: ",a.players.length,"/",a.playersNumber]})]})}),Object(x.jsx)(j.j,{header:Object(x.jsx)(j.k,{children:"\u0418\u0433\u0440\u043e\u043a\u0438"}),children:Object(x.jsx)(j.g,{children:a.players.map((function(e){return Object(x.jsx)(j.t,{before:Object(x.jsx)(j.b,{src:e.photoUrl}),children:e.name},e.id)}))})}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{mode:"commerce",size:"l",stretched:!0,disabled:!(a.players.length===a.playersNumber&&s.isHost),onClick:function(){R(a.id).then((function(e){t(m)})).catch((function(e){return d(e)}))},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}),b&&Object(x.jsx)(ce,{errorMessage:b,closeSnackbar:function(){return d(null)}})]})}var se=c(161);function ie(e){var t=e.actions,c=void 0===t?[]:t;return Object(x.jsx)(x.Fragment,{children:c.map((function(e){return Object(x.jsx)(j.t,{before:Object(x.jsx)(j.b,{src:e.killedPlayer.photoUrl}),description:e.message,children:e.killedPlayer.name},e.id)}))})}var le=c(159),je=c(160),oe=function(e){switch(e){case E:return"\u041c\u0430\u0444\u0438\u044f";case T:return"\u041a\u043e\u043c\u0438\u0441\u0441\u0430\u0440";case V:return"\u041c\u0438\u0440\u043d\u044b\u0439 \u0436\u0438\u0442\u0435\u043b\u044c";default:return"\u041a\u0430\u0440\u0442\u044b \u0441 \u0442\u0430\u043a\u0438\u043c \u0442\u0438\u043f\u043e\u043c \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"}},ue=!0;function be(e){var t=e.player,c=Object(n.useState)(ue),a=Object(l.a)(c,2),r=a[0],s=a[1];return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.x,{level:"2",weight:"medium",children:"\u0422\u0432\u043e\u044f \u043a\u0430\u0440\u0442\u0430"})}),t.card&&Object(x.jsx)(j.t,{after:r?Object(x.jsx)(le.a,{onClick:function(){s(!1),ue=!1}}):Object(x.jsx)(je.a,{onClick:function(){s(!0),ue=!0}}),children:r?oe(t.card.type):"\u041a\u0430\u0440\u0442\u0430 \u0441\u043a\u0440\u044b\u0442\u0430"})]})}var de=function(e){return e.players.filter((function(e){return e.status===q})).length},Oe=function(e,t){return e.players.find((function(e){return e.id===t}))},me=function(e){return e.votingPull.length},he=function(e){return e.status!==K},fe=function(e){return e&&e.gameStatus===M},pe=(c(156),"MafiaWins"),xe="CivilWins";function ge(e){var t=e.setActivePanel,c=e.panelHeaderMessage,a=e.game,r=e.playerId,s=Object(n.useState)(Oe(a,r)),i=Object(l.a)(s,2),o=i[0],b=i[1],d=Object(n.useState)(null),O=Object(l.a)(d,2),m=O[0],h=O[1],f=Object(n.useState)(!1),p=Object(l.a)(f,2),g=p[0],v=p[1],y=Object(n.useState)(null),S=Object(l.a)(y,2),k=S[0],C=S[1],P=function(){h(null),t(u)},M=Object(x.jsxs)(j.n,{activeModal:m,children:[Object(x.jsx)(j.m,{id:pe,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u041f\u043e\u0431\u0435\u0434\u0438\u043b\u0430 \u043c\u0430\u0444\u0438\u044f",icon:Object(x.jsx)(se.a,{}),onClose:P,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:P,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})}),Object(x.jsx)(j.m,{id:xe,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u041f\u043e\u0431\u0435\u0434\u0438\u043b\u0438 \u043c\u0438\u0440\u043d\u044b\u0435 \u0436\u0438\u0442\u0435\u043b\u0438",icon:Object(x.jsx)(se.a,{}),onClose:P,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:P,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})})]});return Object(n.useEffect)((function(){b(Oe(a,r))}),[a]),Object(n.useEffect)((function(){fe(a)&&a.result===D&&h(xe),fe(a)&&a.result===J&&h(pe)}),[a.result]),Object(n.useEffect)((function(){v(!1)}),[a.gamePhase]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{left:Object(x.jsx)(j.q,{onClick:function(){return t(u)}}),children:c}),Object(x.jsx)(j.w,{modal:M,children:Object(x.jsxs)(j.v,{children:[Object(x.jsx)(be,{player:o}),Object(x.jsx)(j.s,{style:{margin:"12px 0"}}),Object(x.jsxs)(j.g,{children:[a.gamePhase===A&&Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){v(!0),X(a.id,o.name).catch((function(e){return C(e)}))},disabled:!he(o)||g,children:0===me(a)?"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0447\u044c":"\u041d\u0430\u0447\u0430\u0442\u044c \u043d\u043e\u0447\u044c (\u0433\u043e\u043b\u043e\u0441\u043e\u0432 ".concat(me(a)," \u0438\u0437 ").concat(de(a),")")}),a.gamePhase===H&&Object(x.jsx)(j.c,{size:"l",stretched:!0,onClick:function(){v(!0),$(a.id,r).catch((function(e){return C(e)}))},disabled:!he(o)||g,children:0===me(a)?"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u0443\u0434":"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u0443\u0434 (\u0433\u043e\u043b\u043e\u0441\u043e\u0432 ".concat(me(a)," \u0438\u0437 ").concat(de(a),")")})]}),he(o)&&g&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),Object(x.jsx)(ie,{actions:a.actions})]})}),k&&Object(x.jsx)(ce,{errorMessage:k,closeSnackbar:function(){return C(null)}})]})}var ve=c(44),ye=function(e,t){return e.players.filter((function(e){return e.id!==t&&e.status!==K}))},Se=function(e){return e.card.type===E};function ke(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,a=e.playerId,r=Object(n.useState)(Oe(c,a)),s=Object(l.a)(r,2),i=s[0],o=s[1],u=Object(n.useState)(ye(c,a)),b=Object(l.a)(u,2),d=b[0],O=(b[1],Object(n.useState)(!1)),m=Object(l.a)(O,2),h=m[0],f=m[1],p=Object(n.useState)(null),g=Object(l.a)(p,2),v=g[0],y=g[1],S=Object(n.useState)(null),k=Object(l.a)(S,2),C=k[0],P=k[1];return Object(ve.useEffect)((function(){o(Oe(c,a))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Se(i)&&he(i)&&!h&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.x,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u0443\u0431\u0438\u0442\u044c?"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){y(e.id===v?null:e.id)},checked:e.id===v,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===v,onClick:function(){f(!0),Y(c.id,i.name,v).catch((function(e){return P(e)}))},children:"\u0423\u0431\u0438\u0442\u044c"})})]}),Se(i)&&he(i)&&h&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),Se(i)&&!he(i)&&Object(x.jsx)(j.g,{children:"\u0412\u044b \u043c\u0435\u0440\u0442\u0432\u044b"}),!Se(i)&&Object(x.jsx)(j.g,{children:"\u0421\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u043d\u043e\u0447\u0438!"}),C&&Object(x.jsx)(ce,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}var Ce=c(162),Pe=function(e){return e.card.type===T},Me="Mafia",Ie="Civil";function we(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,a=e.playerId,r=Object(n.useState)(Oe(c,a)),s=Object(l.a)(r,2),i=s[0],o=s[1],u=Object(n.useState)(ye(c,a)),b=Object(l.a)(u,2),d=b[0],O=(b[1],Object(n.useState)(null)),m=Object(l.a)(O,2),h=m[0],f=m[1],p=Object(n.useState)(null),g=Object(l.a)(p,2),v=g[0],y=g[1],S=Object(n.useState)(null),k=Object(l.a)(S,2),C=k[0],P=k[1],M=function(){y(null),Z(c.id).catch((function(e){return P(e)}))},I=Object(x.jsxs)(j.n,{activeModal:v,children:[Object(x.jsx)(j.m,{id:Me,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u042d\u0442\u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u0430\u0444\u0438\u044f",icon:Object(x.jsx)(Ce.a,{}),onClose:M,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:M,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0445\u043e\u0434"})}),Object(x.jsx)(j.m,{id:Ie,header:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442",subheader:"\u042d\u0442\u043e\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u0438\u0440\u043d\u044b\u0439 \u0436\u0438\u0442\u0435\u043b\u044c",icon:Object(x.jsx)(Ce.a,{}),onClose:M,actions:Object(x.jsx)(j.c,{size:"l",mode:"primary",onClick:M,children:"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0445\u043e\u0434"})})]});return Object(n.useEffect)((function(){o(Oe(c,a))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Pe(i)?Object(x.jsx)(j.w,{modal:I,children:Object(x.jsxs)(j.v,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.x,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c?"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){f(e.id===h?null:e.id)},checked:e.id===h,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===h,onClick:function(){var e=d.find((function(e){return e.id===h}));e.card.type===E?y(Me):y(Ie)},children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c"})})]})}):Object(x.jsx)(j.g,{children:"\u0421\u043f\u043e\u043a\u043e\u0439\u043d\u043e\u0439 \u043d\u043e\u0447\u0438!"}),C&&Object(x.jsx)(ce,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}function He(e){e.setActivePanel;var t=e.panelHeaderMessage,c=e.game,a=e.playerId,r=Object(n.useState)(Oe(c,a)),s=Object(l.a)(r,2),i=s[0],o=s[1],u=Object(n.useState)(ye(c,a)),b=Object(l.a)(u,2),d=b[0],O=(b[1],Object(n.useState)(!1)),m=Object(l.a)(O,2),h=m[0],f=m[1],p=Object(n.useState)(null),g=Object(l.a)(p,2),v=g[0],y=g[1],S=Object(n.useState)(null),k=Object(l.a)(S,2),C=k[0],P=k[1];return Object(n.useEffect)((function(){o(Oe(c,a))}),[c]),Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),he(i)&&!h&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.g,{children:Object(x.jsx)(j.x,{level:"2",weight:"medium",children:"\u041a\u043e\u0433\u043e \u043e\u0441\u0443\u0434\u0438\u0442\u044c??"})}),Object(x.jsx)(j.j,{children:d.map((function(e){return Object(x.jsx)(j.e,{mode:"selectable",before:Object(x.jsx)(j.b,{src:e.photoUrl}),onChange:function(){y(e.id===v?null:e.id)},checked:e.id===v,children:e.name},e.id)}))}),Object(x.jsx)(j.g,{children:Object(x.jsx)(j.c,{size:"l",stretched:!0,mode:"commerce",disabled:null===v,onClick:function(){f(!0),ee(c.id,a,v).catch((function(e){return P(e)}))},children:"\u041e\u0441\u0443\u0434\u0438\u0442\u044c"})})]}),he(i)&&h&&Object(x.jsx)(j.g,{children:"\u0412\u0430\u0448 \u0433\u043e\u043b\u043e\u0441 \u0443\u0447\u0442\u0435\u043d, \u0436\u0434\u0435\u043c \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432"}),!he(i)&&Object(x.jsx)(j.g,{children:"\u0412\u044b \u043c\u0435\u0440\u0442\u0432\u044b"}),C&&Object(x.jsx)(ce,{errorMessage:C,closeSnackbar:function(){return P(null)}})]})}var Ue=c(22),Ae=c.p+"static/media/playersSleep.c4c1ee3c.mp3",Fe=c.p+"static/media/playersWakeUp.8798fe3d.mp3",Ne=c.p+"static/media/mafiaSleep.150eb60b.mp3",ze=c.p+"static/media/mafiaWakeUp.3e03da91.mp3",We=c.p+"static/media/policeSleep.031070aa.mp3",Ge=c.p+"static/media/policeWakeUp.2662b9d8.mp3",_e={playersSleep:new Ue.Howl({src:[Ae]}),playersWakeUp:new Ue.Howl({src:[Fe]}),mafiaSleep:new Ue.Howl({src:[Ne]}),mafiaWakeUp:new Ue.Howl({src:[ze]}),policeSleep:new Ue.Howl({src:[We]}),policeWakeUp:new Ue.Howl({src:[Ge]})};function Ee(e){e.setActivePanel;var t=e.panelHeaderMessage;e.hasSeenIntro;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.p,{children:t}),Object(x.jsx)(j.g,{children:"123"})]})}var Te=function(){var e=Object(n.useState)(null),t=Object(l.a)(e,2),c=t[0],a=t[1],r=Object(n.useState)(null),s=Object(l.a)(r,2),v=s[0],y=s[1],S=Object(n.useState)(null),k=Object(l.a)(S,2),C=k[0],M=k[1],E=Object(n.useState)(null),T=Object(l.a)(E,2),V=T[0],q=T[1],K=Object(n.useState)("main"),J=Object(l.a)(K,2),D=J[0],B=(J[1],Object(n.useState)(u)),L=Object(l.a)(B,2),R=L[0],X=L[1],Y=Object(n.useState)(null),Z=Object(l.a)(Y,2),$=Z[0],ee=Z[1],te=function(e){var t=setInterval((function(){Q(e).then((function(e){a(e.data),q(e.data.gameAudioPhase)}))}),2e3);ee(t)};return Object(n.useEffect)((function(){fe(c)&&(X(m),clearInterval($),ee(null)),(function(e){return e&&e.gameStatus===P&&e.gamePhase===A}(c)||function(e){return e&&e.gameStatus===P&&e.gamePhase===H}(c))&&X(m),function(e){return e&&e.gameStatus===P&&e.gamePhase===I}(c)&&X(h),function(e){return e&&e.gameStatus===P&&e.gamePhase===w}(c)&&X(f),function(e){return e&&e.gameStatus===P&&e.gamePhase===U}(c)&&X(p)}),[c]),Object(n.useEffect)((function(){if(c&&(Oe(c,v).isHost&&(null!==V||void 0!==V)))switch(V){case z:_e.mafiaSleep.play();break;case W:_e.mafiaWakeUp.play();break;case F:_e.playersSleep.play();break;case N:_e.playersWakeUp.play();break;case G:_e.policeSleep.play();break;case _:_e.policeWakeUp.play()}}),[V]),Object(n.useEffect)((function(){i.a.send("VKWebAppGetUserInfo").then((function(e){M(e.photo_200)}))}),[]),Object(n.useEffect)((function(){R===u&&$&&(clearInterval($),ee(null))}),[R]),Object(x.jsx)(j.a,{children:Object(x.jsx)(j.r,{activeView:D,children:Object(x.jsxs)(j.y,{activePanel:R,id:"main",children:[Object(x.jsx)(j.o,{id:o,children:Object(x.jsx)(Ee,{setActivePanel:X,panelHeaderMessage:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!"})}),Object(x.jsx)(j.o,{centered:!0,id:u,className:"home-panel",children:Object(x.jsx)(g,{setActivePanel:X,panelHeaderMessage:"\u041c\u0430\u0444\u0438\u044f"})}),Object(x.jsx)(j.o,{id:b,className:"create-game-panel",children:Object(x.jsx)(ne,{setActivePanel:X,setGame:a,setPlayerId:y,subscribeToGame:te,panelHeaderMessage:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443",playerPhotoUrl:C})}),Object(x.jsx)(j.o,{id:d,children:Object(x.jsx)(ae,{setActivePanel:X,setGame:a,setPlayerId:y,subscribeToGame:te,panelHeaderMessage:"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0438\u0433\u0440\u0435",playerPhotoUrl:C})}),Object(x.jsx)(j.o,{id:O,children:Object(x.jsx)(re,{setActivePanel:X,panelHeaderMessage:"\u0416\u0434\u0435\u043c \u0432\u0441\u0435\u0445 \u0438\u0433\u0440\u043e\u043a\u043e\u0432",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:m,children:Object(x.jsx)(ge,{setActivePanel:X,panelHeaderMessage:"\u0418\u0433\u0440\u0430",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:h,children:Object(x.jsx)(ke,{setActivePanel:X,panelHeaderMessage:"\u041d\u043e\u0447\u044c: \u0445\u043e\u0434 \u041c\u0430\u0444\u0438\u0438",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:f,children:Object(x.jsx)(we,{setActivePanel:X,panelHeaderMessage:"\u041d\u043e\u0447\u044c: \u0445\u043e\u0434 \u041a\u043e\u043c\u0438\u0441\u0441\u0430\u0440\u0430",game:c,playerId:v})}),Object(x.jsx)(j.o,{id:p,children:Object(x.jsx)(He,{setActivePanel:X,panelHeaderMessage:"\u0421\u0443\u0434",game:c,playerId:v})})]})})})};i.a.send("VKWebAppInit"),r.a.render(Object(x.jsx)(Te,{}),document.getElementById("root"))}},[[157,1,2]]]);
//# sourceMappingURL=main.05724ea5.chunk.js.map